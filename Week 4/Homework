#1 Pull total number of orders that were completed on 18th March 2023
SELECT COUNT(Order_id) FROM SALES
WHERE Date = "18-March-2023";

#2 Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name Doe’
SELECT COUNT(s.Order_id) 
FROM SALES AS s join CUSTOMERS AS c
WHERE s.Date = "18-March-2023" and c.first_name = 'John' AND c.last_name = 'Doe';

#3 Pull total number of customers that purchased in January 2023 and the average amount spend per customer
SELECT COUNT(Customer_id) AS Customer_number and (Revenue/Customer_number)
FROM SALES s
WHERE DATE_FORMAT(s.Date, '%Y-%m') = '2023-01';

#4 Pull the departments that generated less than $600 in 2022
SELECT Department 
FROM ITEMS AS i JOIN SALES AS s ON s.Item_id = i.Item_id
WHERE YEAR(s.Date) = 2022
GROUP BY i.department
HAVING SUM(s.Revenue) < 600;

#5 What is the most and least revenue we have generated by an order
SELECT MAX(Revenue) and MIN(Revenue) 
FROM SALES
GROUP BY Order_id

#6 What were the orders that were purchased in our most lucrative order
SELECT *
FROM SALES
WHERE Revenue = (SELECT MAX(Revenue) FROM SALES);
